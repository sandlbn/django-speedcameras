{% load static %}
<!DOCTYPE html>
<html>
  <head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <style type="text/css">
html { height: 100% }
body { height: 100%; margin: 0; padding: 0 }
#description { height: 100px; width: 200px; position: absolute; top: 20px; left: 20px; background-color: #fff; color: #000;z-index: 999; }
#map-canvas { height: 100%;z-index: 1; }
  </style>
  {% autoescape off %}
  <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAXbIz9sLQZBK8pAoWYocwyruw1QXXLqoE&sensor=true"></script>
  <script type="text/javascript">
  function initialize() {
  var mapOptions = {
  center: new google.maps.LatLng(51.248465,22.570735),
  zoom: 13,
  mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var map = new google.maps.Map(document.getElementById("map-canvas"),
                                              mapOptions)
  var image = '{% static 'img/unnamed.png' %}';
  {% for camera in cameras %}
  	var cords = []
  	var marker_{{camera.id}} = new google.maps.Marker({ 
  	position: new google.maps.LatLng({{camera.lat}}, {{camera.lng}}),
  	map: map,
  	icon: image,
  	title: '{{ camera.name }}'
  	});
  	var infowindow_{{ camera.id }} = new google.maps.InfoWindow({
    content: '{{ camera.name }}<br/>{{ camera.description }}' });
    
  google.maps.event.addListener(marker_{{camera.id}}, 'click', function() {
    infowindow_{{ camera.id }}.open(marker_{{camera.id}}.get('map'), marker_{{camera.id}});
  });
  {% for point in camera.polygonpoint_set.all %}
  cords.push(new google.maps.LatLng({{point.lat}}, {{point.lng}}));
  {% endfor %}
    
    polygon = new google.maps.Polygon({
    paths: cords,
    strokeColor: '#FF0000',
    strokeOpacity: 0.8,
    strokeWeight: 2,
    fillColor: '#FF0000',
    fillOpacity: 0.35
    });
    polygon.setMap(map);

    {% endfor %}
}
google.maps.event.addDomListener(window, 'load', initialize);
</script>
{% endautoescape %}
</head>
<body>
<div id="map-canvas"/>
<div id="description"> Mapa Fotoradary</div>
    </body>
    </html>
